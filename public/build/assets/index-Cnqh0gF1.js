import{X as w,r as S,j as e,x as f,A as D}from"./app-BLqjA7mZ.js";import{T as F,a as L,b as h,c as p,d as _,e as r}from"./table-Bz7reh4z.js";import{b as k}from"./button-CZsnkR0p.js";import{B as y}from"./button-dialog-clqY00NY.js";import{D as P}from"./data-table-search-input-DVead7vD.js";const o=[{column:"name",label:"user"},{column:"kd_peserta",label:"Kode Peserta"},{column:"created_at",label:"Tgl. Pendaftaran"},{column:"final_score",label:"Nilai Akhir"}],R=({params:c,setParams:T,participants:x,competition:s})=>{var j;const{criterias:t}=s,{scoreEntries:v,auth:N}=w().props,b=S.useMemo(()=>{if(!t||t.length===0)return o;const a=t.map(l=>({column:`criteria_${l.id}`,label:`${l.name} (${l.weight}%)`})),n=o.findIndex(l=>l.column==="final_score"),i=[...o];return i.splice(n,0,...a),i},[t,o]),d=(j=N.user)==null?void 0:j.data,B=(d==null?void 0:d.role)==="superadmin";function A(){D.post(route("dashboard.superadmin.competitions.calculate-final-scores",s))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx(P,{value:c==null?void 0:c.search,onChange:a=>T(n=>({...n,search:a.target.value}))}),B&&e.jsx(y,{triggerIcon:"IconMedal2",triggerButtonLabel:"Tentukan Pemenang",triggerButtonDisabled:!s.isActive||s.hasFinalScores,dialogTitle:"Konfirmasi",dialogDescription:"Pastikan bahwa seluruh peserta sudah dinilai. Aksi ini akan menghitung nilai akhir dan menonaktifkan perlombaan.",dialogCancelButtonLabel:"Batalkan",dialogActionButtonLabel:"Lanjutkan",dialogActionButtonOnClick:A})]}),e.jsx("div",{className:"h-[calc(80vh-220px)] overflow-auto rounded-md border",children:e.jsxs(F,{children:[e.jsx(L,{children:e.jsxs(h,{children:[e.jsx(p,{className:"w-[50px] text-center",children:"#"}),b.map((a,n)=>e.jsx(p,{children:e.jsx("span",{className:"mr-2 capitalize",children:a.label})},n))]})}),e.jsx(_,{children:x.length>0?e.jsx(e.Fragment,{children:x.map((a,n)=>e.jsxs(h,{children:[e.jsx(r,{className:"w-0 py-7 text-center",children:n+1}),e.jsxs(r,{children:[e.jsx("h3",{children:a.name}),e.jsx("div",{className:"text-muted-foreground",children:a.email})]}),e.jsx(r,{children:a.participantCode}),e.jsx(r,{children:a.createdAt}),t.map((i,l)=>{var g;const u=(g=v[a.id])==null?void 0:g.data,m=u==null?void 0:u.find(I=>I.criteriaId===i.id),C=m==null?void 0:m.score;return e.jsx(r,{children:C??e.jsx(f,{href:route("dashboard.admin.score-entries.create",{competition:s.slug,participant:a.username}),className:k({variant:"link"}),children:"Berikan Nilai"})},l)}),e.jsx(r,{children:s.hasFinalScores?e.jsx(f,{href:route("guest.competitions.leaderboard",s),className:k({variant:"link"}),children:"Lihat di sini"}):e.jsx("span",{className:"animate-pulse text-base font-semibold text-destructive",children:"Belum Ada"})})]},a.id))}):e.jsx(h,{children:e.jsx(r,{colSpan:b.length+2,className:"animate-pulse py-5 text-center text-base font-semibold text-destructive",children:"Data Tidak Ada."})})})]})})]})};export{R as I};

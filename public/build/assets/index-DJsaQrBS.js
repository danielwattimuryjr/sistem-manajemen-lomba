import{X as I,r as S,j as e,x as f,A as D}from"./app-DpEa6Rf_.js";import{T as F,a as L,b as h,c as _,d as w,e as l}from"./table-BqxjZXhO.js";import{b as k}from"./button-31hOb7zH.js";import{B as P}from"./button-dialog-CdPJssXf.js";import{D as y}from"./data-table-search-input-C8sh5O8J.js";const c=[{column:"kd_peserta",label:"Kode Peserta"},{column:"name",label:"user"},{column:"created_at",label:"Tgl. Pendaftaran"},{column:"final_score",label:"Nilai Akhir"}],R=({params:d,setParams:p,participants:x,competition:s})=>{var g;const{criterias:t}=s,{scoreEntries:T,auth:A}=I().props,b=S.useMemo(()=>{if(!t||t.length===0)return c;const a=t.map((r,i)=>({column:`criteria_${r.id}`,label:`C${i+1}`,textAlign:"text-center"})),n=c.findIndex(r=>r.column==="final_score"),o=[...c];return o.splice(n,0,...a),o},[t,c]),u=(g=A.user)==null?void 0:g.data,v=(u==null?void 0:u.role)==="superadmin";function B(){D.post(route("dashboard.superadmin.competitions.calculate-final-scores",s))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx(y,{value:d==null?void 0:d.search,onChange:a=>p(n=>({...n,search:a.target.value}))}),v&&e.jsx(P,{triggerIcon:"IconMedal2",triggerButtonLabel:"Tentukan Pemenang",triggerButtonDisabled:!s.isActive||s.hasFinalScores,dialogTitle:"Konfirmasi",dialogDescription:"Pastikan bahwa seluruh peserta sudah dinilai. Aksi ini akan menghitung nilai akhir dan menonaktifkan perlombaan.",dialogCancelButtonLabel:"Batalkan",dialogActionButtonLabel:"Lanjutkan",dialogActionButtonOnClick:B})]}),e.jsx("div",{className:"h-[calc(80vh-220px)] overflow-auto rounded-md border",children:e.jsxs(F,{children:[e.jsx(L,{children:e.jsx(h,{children:b.map((a,n)=>e.jsx(_,{className:`mr-2 capitalize ${a.textAlign&&a.textAlign}`,children:a.label},n))})}),e.jsx(w,{children:x.length>0?e.jsx(e.Fragment,{children:x.map((a,n)=>e.jsxs(h,{children:[e.jsx(l,{children:a.participantCode}),e.jsxs(l,{children:[e.jsx("h3",{children:a.name}),e.jsx("div",{className:"text-muted-foreground",children:a.email})]}),e.jsx(l,{children:a.createdAt}),t.map((o,r)=>{var j;const i=(j=T[a.id])==null?void 0:j.data,m=i==null?void 0:i.find(C=>C.criteriaId===o.id),N=m==null?void 0:m.score;return e.jsx(l,{className:"text-center",children:N??e.jsx(f,{href:route("dashboard.admin.score-entries.create",{competition:s.slug,participant:a.username}),className:k({variant:"link"}),children:"Berikan Nilai"})},r)}),e.jsx(l,{children:s.hasFinalScores?e.jsx(f,{href:route("guest.competitions.leaderboard",s),className:k({variant:"link"}),children:"Lihat di sini"}):e.jsx("span",{className:"animate-pulse text-base font-semibold text-destructive",children:"Belum Ada"})})]},a.id))}):e.jsx(h,{children:e.jsx(l,{colSpan:b.length+2,className:"animate-pulse py-5 text-center text-base font-semibold text-destructive",children:"Data Tidak Ada."})})})]})})]})};export{R as I};
